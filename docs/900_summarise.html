<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR" xml:lang="fr-FR"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph LARMARANGE">
<meta name="author" content="Roger MARTIN">

<title>R_Guide_notes - summarise</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R_Guide_notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Recherche"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Accueil</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./005_dplyr.html"> 
<span class="menu-text"><code>dplyr</code></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./900_summarise.html" aria-current="page"> 
<span class="menu-text"><code>summarise</code></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Basculer le mode sombre"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#résumez-chaque-groupe-sur-une-seule-ligne" id="toc-résumez-chaque-groupe-sur-une-seule-ligne" class="nav-link active" data-scroll-target="#résumez-chaque-groupe-sur-une-seule-ligne"><span class="header-section-number">0.1</span> Résumez chaque groupe sur une seule ligne</a>
  <ul class="collapse">
  <li><a href="#usage" id="toc-usage" class="nav-link" data-scroll-target="#usage"><span class="header-section-number">0.1.1</span> Usage</a></li>
  <li><a href="#arguments" id="toc-arguments" class="nav-link" data-scroll-target="#arguments"><span class="header-section-number">0.1.2</span> Arguments</a></li>
  <li><a href="#valeur" id="toc-valeur" class="nav-link" data-scroll-target="#valeur"><span class="header-section-number">0.1.3</span> Valeur</a></li>
  <li><a href="#fonctions-utiles" id="toc-fonctions-utiles" class="nav-link" data-scroll-target="#fonctions-utiles"><span class="header-section-number">0.1.4</span> Fonctions utiles</a></li>
  </ul></li>
  <li><a href="#usually-youll-want-to-group-first" id="toc-usually-youll-want-to-group-first" class="nav-link" data-scroll-target="#usually-youll-want-to-group-first"><span class="header-section-number">1</span> Usually, you’ll want to group first</a></li>
  <li><a href="#each-summary-call-removes-one-grouping-level-since-that-group" id="toc-each-summary-call-removes-one-grouping-level-since-that-group" class="nav-link" data-scroll-target="#each-summary-call-removes-one-grouping-level-since-that-group"><span class="header-section-number">2</span> Each summary call removes one grouping level (since that group</a></li>
  <li><a href="#is-now-just-a-single-row" id="toc-is-now-just-a-single-row" class="nav-link" data-scroll-target="#is-now-just-a-single-row"><span class="header-section-number">3</span> is now just a single row)</a></li>
  <li><a href="#beware-reusing-variables-may-lead-to-unexpected-results" id="toc-beware-reusing-variables-may-lead-to-unexpected-results" class="nav-link" data-scroll-target="#beware-reusing-variables-may-lead-to-unexpected-results"><span class="header-section-number">4</span> BEWARE: reusing variables may lead to unexpected results</a></li>
  <li><a href="#refer-to-column-names-stored-as-strings-with-the-.data-pronoun" id="toc-refer-to-column-names-stored-as-strings-with-the-.data-pronoun" class="nav-link" data-scroll-target="#refer-to-column-names-stored-as-strings-with-the-.data-pronoun"><span class="header-section-number">5</span> Refer to column names stored as strings with the <code>.data</code> pronoun:</a></li>
  <li><a href="#in-dplyr-1.1.0-returning-multiple-rows-per-group-was-deprecated-in-favor" id="toc-in-dplyr-1.1.0-returning-multiple-rows-per-group-was-deprecated-in-favor" class="nav-link" data-scroll-target="#in-dplyr-1.1.0-returning-multiple-rows-per-group-was-deprecated-in-favor"><span class="header-section-number">6</span> In dplyr 1.1.0, returning multiple rows per group was deprecated in favor</a></li>
  <li><a href="#of-reframe-which-never-messages-and-always-returns-an-ungrouped" id="toc-of-reframe-which-never-messages-and-always-returns-an-ungrouped" class="nav-link" data-scroll-target="#of-reframe-which-never-messages-and-always-returns-an-ungrouped"><span class="header-section-number">7</span> of <code>reframe()</code>, which never messages and always returns an ungrouped</a></li>
  <li><a href="#result" id="toc-result" class="nav-link" data-scroll-target="#result"><span class="header-section-number">8</span> result:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><code>summarise</code></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Auteur·rice·s</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://larmarange.github.io/guide-R/">Joseph LARMARANGE</a> </p>
             <p>Roger MARTIN <a href="mailto:Roger57que@free.fr" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Date de publication</div>
    <div class="quarto-title-meta-contents">
      <p class="date">lun. 29 avr. 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modifié</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">jeu. 02 mai 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="résumez-chaque-groupe-sur-une-seule-ligne" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="résumez-chaque-groupe-sur-une-seule-ligne"><span class="header-section-number">0.1</span> Résumez chaque groupe sur une seule ligne</h2>
<p>Source:<a href="https://github.com/tidyverse/dplyr/blob/HEAD/R/summarise.R">R/summarise.R</a></p>
<p><code>summarise()</code> crée un nouveau bloc de données. Il renvoie une ligne pour chaque combinaison de variables de regroupement ; s’il n’y a pas de variables de regroupement, la sortie aura une seule ligne résumant toutes les observations dans l’entrée. Il contiendra une colonne pour chaque variable de regroupement et une colonne pour chacune des statistiques récapitulatives que vous avez spécifiées.</p>
<p><code>summarise()</code>et <code>summarize()</code> sont des synonymes.</p>
<section id="usage" class="level3" data-number="0.1.1">
<h3 data-number="0.1.1" class="anchored" data-anchor-id="usage"><span class="header-section-number">0.1.1</span> Usage</h3>
<p><code>summarise(.data, ..., .by = NULL, .groups = NULL)</code></p>
<p><code>summarize(.data, ..., .by = NULL, .groups = NULL)</code></p>
</section>
<section id="arguments" class="level3" data-number="0.1.2">
<h3 data-number="0.1.2" class="anchored" data-anchor-id="arguments"><span class="header-section-number">0.1.2</span> Arguments</h3>
<dl>
<dt><code>.data</code></dt>
<dd>
<p>Un jeu de données, une extension de jeu de données (par exemple un <code>tibble</code>). Voir <em>Méthodes</em> ci-dessous pour plus de détails.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p><code>&lt; data-masking&gt;</code> Paires nom-valeur de fonctions récapitulatives. Le nom sera le nom de la variable dans le résultat.</p>
</dd>
<dd>
<p>La valeur peut être :</p>
</dd>
<dd>
<ul>
<li><p>Un vecteur de longueur 1, par exemple <code>min(x)</code>, <code>n()</code>, ou <code>sum(is.na(y))</code></p></li>
<li><p>Un jeu de données, pour ajouter plusieurs colonnes à partir d’une seule expression.</p></li>
</ul>
</dd>
<dt><code>.by</code> [Expérimental]</dt>
<dd>
<p><code>&lt; tidy-select&gt;</code> En option, une sélection de colonnes à regrouper uniquement pour cette opération, fonctionnant comme une alternative à <a href="https://dplyr.tidyverse.org/reference/group_by.html"><code>group_by()</code></a>. Pour plus de détails et des exemples, tapez <a href="https://dplyr.tidyverse.org/reference/dplyr_by.html"><code>?dplyr_by</code></a> .</p>
</dd>
<dt><code>.groups</code> [Expérimental]</dt>
<dd>
<p>Structure de regroupement du résultat.</p>
</dd>
<dd>
<ul>
<li><p>“<code>drop_las</code>t” : suppression du dernier niveau de regroupement. C’était la seule option prise en charge avant la version 1.0.0.</p></li>
<li><p>“<code>drop</code>” : tous les niveaux de regroupement sont supprimés.</p></li>
<li><p>“<code>keep</code>” : Même structure de regroupement que .data.</p></li>
<li><p>“<code>rowwise</code>” : chaque ligne est son propre groupe.</p></li>
</ul>
</dd>
<dd>
<p>Lorsque <code>.groups</code> n’est pas précisé, il est choisi en fonction du nombre de lignes des résultats&nbsp;:</p>
</dd>
<dd>
<ul>
<li><p>si tous les résultats comportent 1 ligne, on obtient “<code>drop_last</code>”.</p></li>
<li><p>si le nombre de lignes varie, vous obtenez « <code>keep</code> » (à noté que le renvoi d’un nombre variable de lignes est obsolète au profit de <a href="https://dplyr.tidyverse.org/reference/reframe.html"><code>reframe()</code></a>, ce qui supprime également sans condition tous les niveaux de regroupement).</p></li>
</ul>
</dd>
</dl>
<p>De plus, un message vous informe de ce choix, sauf si le résultat est <code>ungroup()</code>, si l’option “<code>dplyr.summarise.inform</code>” est définie sur <code>FALSE</code>, ou lorsque <code>summarise()</code> est appelée depuis une fonction d’un package.</p>
</section>
<section id="valeur" class="level3" data-number="0.1.3">
<h3 data-number="0.1.3" class="anchored" data-anchor-id="valeur"><span class="header-section-number">0.1.3</span> Valeur</h3>
<p>Un objet généralement du même type que <code>.data</code>.</p>
<ul>
<li><p>Les lignes proviennent du <code>group_keys()</code>.</p></li>
<li><p>Les colonnes sont une combinaison des clés de regroupement et des expressions récapitulatives fournient.</p></li>
<li><p>La structure de regroupement est contrôlée par l’argument <code>.groups=,</code> la sortie peut être un autre <code>grouped_df</code> , un <code>tibble</code> ou un jeu de données placé en <code>rowwise()</code></p></li>
<li><p>Les attributs du bloc de données ne sont pas conservés, car <code>summarise()</code> crée fondamentalement un nouveau jeu de données.</p></li>
</ul>
</section>
<section id="fonctions-utiles" class="level3" data-number="0.1.4">
<h3 data-number="0.1.4" class="anchored" data-anchor-id="fonctions-utiles"><span class="header-section-number">0.1.4</span> Fonctions utiles</h3>
<p>Centre: mean(),median()</p>
<p>Propagé: sd(), IQR(),mad()</p>
<p>Gamme: min(), max(),</p>
<p>Position: first(), last(), nth(),</p>
<p>Compter: n(),n_distinct()</p>
<p>Logique : any(),all()</p>
<p>Variantes du back-end Le <a href="https://fr.wikipedia.org/wiki/Backend">back-end</a> du bloc de données prend en charge la création d’une variable et son utilisation dans le même résumé. Cela signifie que les variables récapitulatives créées précédemment peuvent être transformées ou combinées davantage dans le résumé, comme dans mutate(). Cependant, cela signifie également que les variables récapitulatives portant les mêmes noms que les variables précédentes les écrasent, rendant ces variables indisponibles pour les variables récapitulatives ultérieures.</p>
<p>Ce comportement peut ne pas être pris en charge dans d’autres backends. Pour éviter des résultats inattendus, envisagez d’utiliser de nouveaux noms pour vos variables récapitulatives, en particulier lors de la création de plusieurs résumés.</p>
<p>Méthodes Cette fonction est générique , ce qui signifie que les packages peuvent fournir des implémentations (méthodes) pour d’autres classes. Consultez la documentation des méthodes individuelles pour connaître les arguments supplémentaires et les différences de comportement.</p>
<p>Les méthodes suivantes sont actuellement disponibles dans les packages chargés : dbplyr ( tbl_lazy), dplyr ( data.frame, grouped_df, rowwise_df) .</p>
<p>Voir également Autres verbes à table unique : arrange(), filter(), mutate(), reframe(), rename(), select(), slice()</p>
<p>Exemples # A summary applied to ungrouped tbl returns a single row mtcars %&gt;% summarise(mean = mean(disp), n = n()) #&gt; mean n #&gt; 1 230.7219 32</p>
</section>
</section>
<section id="usually-youll-want-to-group-first" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Usually, you’ll want to group first</h1>
<p>mtcars %&gt;% group_by(cyl) %&gt;% summarise(mean = mean(disp), n = n()) #&gt; # A tibble: 3 × 3 #&gt; cyl mean n #&gt; <dbl> <dbl> <int> #&gt; 1 4 105. 11 #&gt; 2 6 183. 7 #&gt; 3 8 353. 14</int></dbl></dbl></p>
</section>
<section id="each-summary-call-removes-one-grouping-level-since-that-group" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Each summary call removes one grouping level (since that group</h1>
</section>
<section id="is-now-just-a-single-row" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> is now just a single row)</h1>
<p>mtcars %&gt;% group_by(cyl, vs) %&gt;% summarise(cyl_n = n()) %&gt;% group_vars() #&gt; <code>summarise()</code> has grouped output by ‘cyl’. You can override using the #&gt; <code>.groups</code> argument. #&gt; [1] “cyl”</p>
</section>
<section id="beware-reusing-variables-may-lead-to-unexpected-results" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> BEWARE: reusing variables may lead to unexpected results</h1>
<p>mtcars %&gt;% group_by(cyl) %&gt;% summarise(disp = mean(disp), sd = sd(disp)) #&gt; # A tibble: 3 × 3 #&gt; cyl disp sd #&gt; <dbl> <dbl> <dbl> #&gt; 1 4 105. NA #&gt; 2 6 183. NA #&gt; 3 8 353. NA</dbl></dbl></dbl></p>
</section>
<section id="refer-to-column-names-stored-as-strings-with-the-.data-pronoun" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Refer to column names stored as strings with the <code>.data</code> pronoun:</h1>
<p>var &lt;- “mass” summarise(starwars, avg = mean(.data[[var]], na.rm = TRUE)) #&gt; # A tibble: 1 × 1 #&gt; avg #&gt; <dbl> #&gt; 1 97.3 # Learn more in ?rlang::args_data_masking</dbl></p>
</section>
<section id="in-dplyr-1.1.0-returning-multiple-rows-per-group-was-deprecated-in-favor" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> In dplyr 1.1.0, returning multiple rows per group was deprecated in favor</h1>
</section>
<section id="of-reframe-which-never-messages-and-always-returns-an-ungrouped" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> of <code>reframe()</code>, which never messages and always returns an ungrouped</h1>
</section>
<section id="result" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> result:</h1>
<p>mtcars %&gt;% group_by(cyl) %&gt;% summarise(qs = quantile(disp, c(0.25, 0.75)), prob = c(0.25, 0.75)) #&gt; Warning: Returning more (or less) than 1 row per <code>summarise()</code> group was #&gt; deprecated in dplyr 1.1.0. #&gt; ℹ Please use <code>reframe()</code> instead. #&gt; ℹ When switching from <code>summarise()</code> to <code>reframe()</code>, remember that #&gt; <code>reframe()</code> always returns an ungrouped data frame and adjust #&gt; accordingly. #&gt; <code>summarise()</code> has grouped output by ‘cyl’. You can override using the #&gt; <code>.groups</code> argument. #&gt; # A tibble: 6 × 3 #&gt; # Groups: cyl [3] #&gt; cyl qs prob #&gt; <dbl> <dbl> <dbl> #&gt; 1 4 78.8 0.25 #&gt; 2 4 121. 0.75 #&gt; 3 6 160 0.25 #&gt; 4 6 196. 0.75 #&gt; 5 8 302. 0.25 #&gt; 6 8 390 0.75 # -&gt; mtcars %&gt;% group_by(cyl) %&gt;% reframe(qs = quantile(disp, c(0.25, 0.75)), prob = c(0.25, 0.75)) #&gt; # A tibble: 6 × 3 #&gt; cyl qs prob #&gt; <dbl> <dbl> <dbl> #&gt; 1 4 78.8 0.25 #&gt; 2 4 121. 0.75 #&gt; 3 6 160 0.25 #&gt; 4 6 196. 0.75 #&gt; 5 8 302. 0.25 #&gt; 6 8 390 0.75</dbl></dbl></dbl></dbl></dbl></dbl></p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Réutilisation</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.fr_fr">CC BY-NC-SA 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>